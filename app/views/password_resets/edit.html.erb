<h1>Reset Your Password</h1>

<%= form_with url: update_password_path, method: :patch, local: true do |form| %>
  <div class="field">
    <%= form.label :password, "New Password" %>
    <%= form.password_field :password, minlength: 8 %>
  </div>

  <div class="field">
    <%= form.label :password_confirmation, "Confirm New Password" %>
    <%= form.password_field :password_confirmation %>
  </div>

  <%= hidden_field_tag :token, params[:token] %>

  <div class="actions">
    <%= form.submit "Reset Password" %>
  </div>
<% end %>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const password = document.getElementById("password");
    const passwordConfirmation = document.getElementById("password_confirmation");

    function validatePassword() {
      if (password.value !== passwordConfirmation.value) {
        passwordConfirmation.setCustomValidity("Passwords do not match.");
      } else {
        passwordConfirmation.setCustomValidity("");
      }
    }

    password.onchange = validatePassword;
    passwordConfirmation.onkeyup = validatePassword;
  });
</script>
